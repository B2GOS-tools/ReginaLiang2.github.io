<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.68">
<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-182220822-1"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","UA-182220822-1",{})</script>
<link rel="search" type="application/opensearchdescription+xml" title="KaiOS, Enable tomorrow" href="/opensearch.xml">
<link rel="icon" href="/img/favicon.png">
<link rel="manifest" href="/manifest.json">
<meta name="theme-color" content="rgb(37, 194, 160)"><title data-react-helmet="true">Data Store | KaiOS, Enable tomorrow</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" name="docsearch:language" content="en"><meta data-react-helmet="true" name="docsearch:docusaurus_tag" content="default"><meta data-react-helmet="true" property="og:title" content="Data Store | KaiOS, Enable tomorrow"><meta data-react-helmet="true" name="description" content="Description"><meta data-react-helmet="true" property="og:description" content="Description"><meta data-react-helmet="true" property="og:url" content="https://ReginaLiang.github.io/docs/06.api/web-apis/dataStore/data-store"><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.png"><link data-react-helmet="true" rel="canonical" href="https://ReginaLiang.github.io/docs/06.api/web-apis/dataStore/data-store"><link rel="stylesheet" href="/styles.e4c56f30.css">
<link rel="preload" href="/styles.99f3a320.js" as="script">
<link rel="preload" href="/runtime~main.ca14ff1c.js" as="script">
<link rel="preload" href="/main.e44638f4.js" as="script">
<link rel="preload" href="/1.9884b0e9.js" as="script">
<link rel="preload" href="/321.3e1d6c96.js" as="script">
<link rel="preload" href="/1be78505.6d4950b0.js" as="script">
<link rel="preload" href="/935f2afb.232a5219.js" as="script">
<link rel="preload" href="/320.2ec167c3.js" as="script">
<link rel="preload" href="/a7143e1d.3453e2e0.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<nav aria-label="Skip navigation links"><button type="button" tabindex="0" class="skipToContent_2AhQ">Skip to main content</button></nav><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/"><img src="/img/logo.svg" alt="My Site Logo" class="themedImage_2E_h themedImage--light_AouX navbar__logo"><img src="/img/logo.svg" alt="My Site Logo" class="themedImage_2E_h themedImage--dark_1YPN navbar__logo"></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/">Docs</a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class="navbar__item navbar__link" href="/docs/">Smart Feature Phone 2.5</a><ul class="dropdown__menu"><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/docs/06.api/web-apis/dataStore/data-store">Smart Feature Phone 2.5</a></li><li><a class="dropdown__link" href="/docs/sfp-3.0/">Smart Feature Phone 3.0</a></li><li><a class="dropdown__link" href="/versions">All versions</a></li></ul></div><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_2aTZ"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_BsTx">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_BsTx">ðŸŒž</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div><div class="navbar__search"><span aria-label="expand searchbar" role="button" class="search-icon" tabindex="0"></span><input type="search" id="search_input_react" placeholder="Search" aria-label="Search" class="navbar__search-input search-bar"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><img src="/img/logo.svg" alt="My Site Logo" class="themedImage_2E_h themedImage--light_AouX navbar__logo"><img src="/img/logo.svg" alt="My Site Logo" class="themedImage_2E_h themedImage--dark_1YPN navbar__logo"></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/docs/">Docs</a></li><li class="menu__list-item"><a role="button" class="menu__link menu__link--sublist">Versions</a><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active" href="/docs/06.api/web-apis/dataStore/data-store">Smart Feature Phone 2.5</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/sfp-3.0/">Smart Feature Phone 3.0</a></li><li class="menu__list-item"><a class="menu__link" href="/versions">All versions</a></li></ul></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_17aD"><div class="APIsSidebarContainer_3Wwj" role="complementary"><div class="sidebar_1oZY menu menu_ZmYR menu--responsive"><button aria-label="Open Menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_293r" xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 0 32 32" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><div class="menu__list sidebarContent_1p49"><div class="menu_17eA menu--responsive breadcrumb_2PlI"><a href="" class="breadcrumb-link_zgVW rootPath_19ky">API</a><span>&gt;<a href="/docs/06.api/web-apis/dataStore/data-store" class="breadcrumb-link_zgVW">Data Store</a></span></div><div class="relatedPageContainer_2TNh"><div class="related-pages-title_1llK">Related Pages</div><div class="relatedPageList_38YE"><ul class="related-pages_1R6X"><li class="related-pages-item_1Y8v"><a href="/docs/06.api/web-apis/dataStore/datastore">DataStore</a></li><li class="related-pages-item_1Y8v"><a href="/docs/06.api/web-apis/dataStore/datastorechangeevent">DataStoreChangeEvent</a></li><li class="related-pages-item_1Y8v"><a href="/docs/06.api/web-apis/dataStore/datastorecursor">DataStoreCursor</a></li><li class="related-pages-item_1Y8v"><a href="/docs/06.api/web-apis/dataStore/datastoretask">DataStoreTask</a></li></ul></div></div></div><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_G0vy"></button></div></div><main class="docMainContainer_3N9f"><div class="container padding-vert--lg docItemWrapper_3j07"><div class="row"><div class="col docItemCol_2ASc"><div class="docItemContainer_3QWW"><article><div><span class="badge badge--secondary">Version: Smart Feature Phone 2.5</span></div><header><h1 class="docTitle_1Lrw">Data Store</h1></header><div class="markdown"><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="description"></a>Description<a aria-hidden="true" class="hash-link" href="#description" title="Direct link to heading">#</a></h2><p>The Data Store API provides a powerful, flexible storage mechanism for KaiOS applications to use to store and share data. It is basically an intermediary store to allow multiple applications to share data between one another quickly, efficiently, and securely, in spite of differences between API data structures, formats, etc.
Data Store API concepts and usage</p><p>The Data Store API was created to allow multiple KaiOS apps, with potentially different data structures and storage mechanisms, to create, maintain and share the same data objects efficiently between one another. Each app can then import the data into its own local IndexedDB to index according to their specific query needs. This is not necessary however, and you can just write directly to the Data Store API data store.</p><blockquote><p><strong>Note:</strong> The Data Store API is available in Web Workers</p></blockquote><p>There are several possible reasons to use this API, including:</p><ul><li>It lets an application create data that it can then share with other applications.</li><li>It lets multiple applications supply data to the same data store.</li><li>It supports read-only data stores such as Facebook contacts (that is, it lets one app create and maintain the data while other apps can read the data from the store).</li><li>It supports read/write data stores, so that multiple applications can contribute data to the same data store. An example would be the device&#x27;s standard contacts, which can be updated by both the built-in Contacts app and third-party apps.</li><li>It supports keeping an application-locale cache of a data store, with notifications to let the app know when there have been changes to the master data store so that the cache can be updated.</li></ul><p>This Data Store API datastore is owned by a specific app (as specified by the datastores-owned field in the app&#x27;s manifest â€” see Manifest_fields, below), and this ownership gives the app the right to populate the data store and declare whether the data store is <code>readonly</code> (meaning other apps can only read the data) or <code>readwrite</code> (meaning other apps can modify the data as well as read it.) Other apps can gain access to a datastore by naming it in the <code>datastores-access</code> field of their app manifest.</p><p>When an app wants to access a datastore, it has to call <code>Navigator.getDataStores()</code>; The result value of this method is a <code>Promise</code> object that will resolve with an array of <code>DataStore</code> objects. From these <code>DataStore</code> objects, the app can read and modify values using various methods of the <code>DataStore</code> such as <code>DataStore.get()</code> and <code>DataStore.insert()</code>.</p><blockquote><p><strong>Note:</strong> The Data Store API currently has no imposed limitations on storage space. This is likely to be updated in the near future.</p></blockquote><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="change-management-and-conflict-resolution"></a>Change management and conflict resolution<a aria-hidden="true" class="hash-link" href="#change-management-and-conflict-resolution" title="Direct link to heading">#</a></h3><p>When multiple apps make changes to a Data Store, it could create conflicts. However, any change you make (using <code>DataStore.update()</code>, <code>DataStore.add()</code>, etc.) is given a <code>revisionId</code>, a UUID received in the change event fired whenever a operation is performed on the Data Store by any app with access to it. This can be read from the <code>DataStore.revisionId</code> property.</p><p>The <code>revisionId</code> property can be included as an optional parameter in the <code>DataStore.add()</code>, <code>DataStore.put()</code>, <code>DataStore.remove()</code>, <code>DataStore.clear()</code>, and <code>DataStore.sync()</code> methods. Doing so basically uses that <code>revisionId</code> as a conflict avoider â€” the operation is aborted if that revisionId is not the last one known by the Data Store (i.e. if another app has made a more recent change).</p><p>When the change event is fired, it receives a <code>DataStoreChangeEvent</code> object, giving the app access to:</p><ul><li>DataStoreChangeEvent.revisionId: The last known revisionId.</li><li>DataStoreChangeEvent.id: The key of the changed object, which can be null if the operation was a clear().</li><li>DataStoreChangeEvent.operation: The operation that was performed â€” add(), remove(), etc.</li><li>DataStoreChangeEvent.owner: The manifest URL of the app that performed this operation.</li></ul><p>When an app wants to see what has changed, it can do it by asking for the â€˜deltaâ€™ between the last known revisionId and the current one. This is done using the DataStore.sync() method. You can allow your apps to deal with data changes by running a sync() on application startup and onchange, passing it the current revisionId to check against.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="filtering-data"></a>Filtering data<a aria-hidden="true" class="hash-link" href="#filtering-data" title="Direct link to heading">#</a></h3><p>As hinted at above, the Data Store API is not responsible for filtering data or building indexes; instead it leaves this up to the the app&#x27;s local storage mechanism (usually an IndexedDB); The Data Store API simply allows the local indexes to be kept up to date, via the DataStoreCursor object, created when sync() is invoked.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="properties"></a>Properties<a aria-hidden="true" class="hash-link" href="#properties" title="Direct link to heading">#</a></h2><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="manifest-fields"></a>Manifest fields<a aria-hidden="true" class="hash-link" href="#manifest-fields" title="Direct link to heading">#</a></h2><p>The data store owner&#x27;s manifest MUST include the datastores-owned field to claim ownership, for example:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-json codeBlock_3iAC thin-scrollbar"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token property">&quot;datastores-owned&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token property">&quot;myData&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token property">&quot;access&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;readwrite&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token property">&quot;description&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;my data store&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div><p>You can include multiple properties to represent different data stores, and each one can use readonly/readwrite to specify whether the data store can be read/modified by other applications. A description is also included to describe the purpose of the data store.</p><p>Other applications that want to access (not own) the data store must include the datastores-access field, for example:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-json codeBlock_3iAC thin-scrollbar"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token property">&quot;datastores-access&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token property">&quot;myData&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token property">&quot;access&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;readonly&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token property">&quot;description&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;Read and modify my data store&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div><p>Without this field being specified, the default behavior is &quot;no access&quot;. Again, multiple properties can be included if you want to access multiple data stores, and an access of readonly or readwrite can be set to declare what access type is needed by the app.</p><p>In terms of permissions, the Data Store owner always wins against the 3rd party apps. if the owner declares &quot;readonly&quot;: true in its manifest, any 3rd party app will be in readonly mode also, even if they declare &quot;access&quot;: &quot;readwrite&quot; in their manifests. Of course, this isnâ€™t much use if the owner allows the Data Store to be modified by third party apps, so for the moment, Data Store is a certified API. It is likely to come down to privileged when the security model is finalized.</p><blockquote><p>Note: Remember also that in such cases you need to use the type field in your manifest to explicitly declare that your app is an internal/certified app: &quot;type&quot;: &quot;certified&quot;.</p></blockquote><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="datastore-api-interfaces"></a>DataStore API Interfaces<a aria-hidden="true" class="hash-link" href="#datastore-api-interfaces" title="Direct link to heading">#</a></h2><p>The Data Store API contains the following interfaces:</p><ul><li><a href="/docs/06.api/web-apis/dataStore/datastore"><strong><code>DataStore</code></strong></a><br>The DataStore interface represents a retrieved set of data, and includes standard properties for accessing the store&#x27;s name, owner, etc., methods for reading, modifying and syncing the data, and the onchange event handler for reacting to changes to the data.</li><li><a href="/docs/06.api/web-apis/dataStore/datastorecursor"><strong><code>DataStoreCursor</code></strong></a><br>This interface allows the app to iterate through a list of DataStoreTask objects representing the change history of the data store, for use when synchronising the data.</li><li><a href="/docs/06.api/web-apis/dataStore/datastorechangeevent"><strong><code>DataStoreChangeEvent</code></strong></a><br>This interface represents the event related to a record changed in the data store, i.e. this is returned once a change is made and the change event is fired (see DataStore.onchange for the handler), for use when synchronizing individual changes.</li><li><a href="/docs/06.api/web-apis/dataStore/datastoretask"><strong><code>DataStoreTask</code></strong></a><br>This interface represents a record changed in the data store when a DataStoreCursor is used to iterate through the data store&#x27;s change history.</li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="methods"></a>Methods<a aria-hidden="true" class="hash-link" href="#methods" title="Direct link to heading">#</a></h2><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="examples"></a>Examples<a aria-hidden="true" class="hash-link" href="#examples" title="Direct link to heading">#</a></h2><p>We have written a couple of examples that go together, to explain how different apps can make different use of the same data store:</p><ul><li>The Data Store Contacts Editor creates a data store called &#x27;contacts&#x27; on the device it is installed on, adds some default data to it, and allows the user to add new contacts to the store and delete contacts.</li><li>The Data Store Contacts Viewer has readonly access to the &#x27;contacts&#x27; data store; it grabs data from it and displays it in a user interface, along with a Google map of the selected user&#x27;s location, displayed in an <code>&lt;iframe&gt;</code> to get around certified app CSP restrictions.</li></ul><p>Keep referring to these examples and read Using the Data Store API for explanations and code samples.</p><blockquote><p><strong>Note:</strong> Be aware that to test data store examples you need to make sure your apps are internal/certified (see above for manifest fields needed), and use App Manager or WebIDE to simulate an environment where a internal/certified app can be run. Follow these links to find out how to do this using each tool: App Manager: Debugging Certified Apps and WebIDE: Debugging Certified Apps.</p></blockquote></div></article><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"></div><div class="pagination-nav__item pagination-nav__item--next"></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_3SO_ thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#description" class="table-of-contents__link">Description</a><ul><li><a href="#change-management-and-conflict-resolution" class="table-of-contents__link">Change management and conflict resolution</a></li><li><a href="#filtering-data" class="table-of-contents__link">Filtering data</a></li></ul></li><li><a href="#properties" class="table-of-contents__link">Properties</a></li><li><a href="#manifest-fields" class="table-of-contents__link">Manifest fields</a></li><li><a href="#datastore-api-interfaces" class="table-of-contents__link">DataStore API Interfaces</a></li><li><a href="#methods" class="table-of-contents__link">Methods</a></li><li><a href="#examples" class="table-of-contents__link">Examples</a></li></ul></div></div></div></div></main></div></div><footer class="footer_mib0 footer--dark"><div class="footer__content_2gOk"><a href="https://www.kaiostech.com/" class="home__link_3FF2"><img alt="foot logo" class="kaios__logo_Tlat" src="/img/footer-logo.svg" title="foot logo"></a><div class="footer__column--right_1XPX"><div class="footer__items_3gGI"><ul class="footer__items_3gGI"><li class="footer__item_1JzF"><a href="https://www.kaiostech.com/terms-of-service/" rel="noopener noreferrer" target="_blank">Terms of Service</a></li><li class="footer__item_1JzF"><a href="https://www.kaiostech.com/privacy-policy" rel="noopener noreferrer" target="_blank">Privacy Policy</a></li><li class="footer__item_1JzF"><a href="https://www.kaiostech.com/sub-agreement" rel="noopener noreferrer" target="_blank">Submission Agreement</a></li></ul></div><span class="footer__copyright_1o2i">All right reserved Â© KaiOS 2018 - 2020.</span></div></div></footer></div>
<script src="/styles.99f3a320.js"></script>
<script src="/runtime~main.ca14ff1c.js"></script>
<script src="/main.e44638f4.js"></script>
<script src="/1.9884b0e9.js"></script>
<script src="/321.3e1d6c96.js"></script>
<script src="/1be78505.6d4950b0.js"></script>
<script src="/935f2afb.232a5219.js"></script>
<script src="/320.2ec167c3.js"></script>
<script src="/a7143e1d.3453e2e0.js"></script>
</body>
</html>