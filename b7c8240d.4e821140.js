(window.webpackJsonp=window.webpackJsonp||[]).push([[226],{300:function(e,t,a){"use strict";a.r(t),a.d(t,"frontMatter",(function(){return p})),a.d(t,"metadata",(function(){return o})),a.d(t,"rightToc",(function(){return c})),a.d(t,"default",(function(){return s}));var n=a(3),r=a(8),i=(a(0),a(398)),l=a(400),p={id:"overview",title:"3.0 Overview"},o={unversionedId:"01.introduction/overview",id:"version-sfp-3.0/01.introduction/overview",isDocsHomePage:!1,title:"3.0 Overview",description:"New Gecko",source:"@site/versioned_docs/version-sfp-3.0/01.introduction/nextOverView.md",slug:"/01.introduction/overview",permalink:"/docs/sfp-3.0/01.introduction/overview",version:"sfp-3.0",sidebar:"version-sfp-3.0/docs",previous:{title:"KaiOS History",permalink:"/docs/sfp-3.0/01.introduction/history"},next:{title:"OS ENV Setup",permalink:"/docs/sfp-3.0/02.getting-started/01.env-setup/os-env-setup"}},c=[{value:"New Gecko",id:"new-gecko",children:[]},{value:"New Gonk layer",id:"new-gonk-layer",children:[{value:"<strong>HIDL interface used by KaiOS3.0</strong>",id:"hidl-interface-used-by-kaios30",children:[]}]},{value:"Web API changes",id:"web-api-changes",children:[]},{value:"NewKai-RIL design",id:"newkai-ril-design",children:[{value:"V2.5 RIL",id:"v25-ril",children:[]},{value:"V3.0 RIL",id:"v30-ril",children:[]}]},{value:"Service Worker change",id:"service-worker-change",children:[]},{value:"Geolocation change",id:"geolocation-change",children:[]},{value:"New Apps manager",id:"new-apps-manager",children:[]},{value:"App types in KaiOS 3.0",id:"app-types-in-kaios-30",children:[]},{value:"App origin changed in KaiOS 3.0",id:"app-origin-changed-in-kaios-30",children:[]},{value:"App manifest",id:"app-manifest",children:[{value:"App manifest required",id:"app-manifest-required",children:[]},{value:"App manifest optinal",id:"app-manifest-optinal",children:[]}]},{value:"Permission Management",id:"permission-management",children:[]},{value:"Progressive Web Application support (PWA)",id:"progressive-web-application-support-pwa",children:[]},{value:"Gaia Change",id:"gaia-change",children:[]}],b={rightToc:c};function s(e){var t=e.components,a=Object(r.a)(e,["components"]);return Object(i.b)("wrapper",Object(n.a)({},b,a,{components:t,mdxType:"MDXLayout"}),Object(i.b)("h2",{id:"new-gecko"},"New Gecko"),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},"Using ",Object(i.b)("strong",{parentName:"li"},"Gecko")," version ",Object(i.b)("strong",{parentName:"li"},"82.0"),"(Aug. 28, 2020)"),Object(i.b)("li",{parentName:"ul"},Object(i.b)("strong",{parentName:"li"},"Keep updating from upstream till FC (ETA Sep. 30, 2020)")),Object(i.b)("li",{parentName:"ul"},"Gecko changes since version 48",Object(i.b)("ul",{parentName:"li"},Object(i.b)("li",{parentName:"ul"},Object(i.b)("a",Object(n.a)({parentName:"li"},{href:"https://wiki.developer.mozilla.org/en-US/docs/Mozilla/Firefox/Releases"}),"FireFox Releases")))),Object(i.b)("li",{parentName:"ul"},"Mozilla abanden Firefox OS project since gecko 53, RD team take a lot efforts to bring those mobile device related APIs,\nsystem message, web activity, permission management, process manager, \u2026 back to new gecko"),Object(i.b)("li",{parentName:"ul"},"Enhanced Service Worker"),Object(i.b)("li",{parentName:"ul"},"Modern JS (ECMAScript 2021)"),Object(i.b)("li",{parentName:"ul"},"PWA (Progress Web App) support"),Object(i.b)("li",{parentName:"ul"},"WebRender"),Object(i.b)("li",{parentName:"ul"},"WebAssembly"),Object(i.b)("li",{parentName:"ul"},"WebRTC and WebAudio improve"),Object(i.b)("li",{parentName:"ul"},"WebGL 2 interface to OpenGL ES 3.0"),Object(i.b)("li",{parentName:"ul"},"Quantum CSS (parallel CSS engine)"),Object(i.b)("li",{parentName:"ul"},"TLS 1.0, 1.1 dropped (1.2,1.3 remain)"),Object(i.b)("li",{parentName:"ul"},"Web Annimation API"),Object(i.b)("li",{parentName:"ul"},"WebP support"),Object(i.b)("li",{parentName:"ul"},"Media capabilities API"),Object(i.b)("li",{parentName:"ul"},"Speech Sysnthesis API"),Object(i.b)("li",{parentName:"ul"},"Web Authentication API"),Object(i.b)("li",{parentName:"ul"},"Encryped Media Extension API (EME)"),Object(i.b)("li",{parentName:"ul"},"Accepts some Webkit prefixed properties and attributes")),Object(i.b)("hr",null),Object(i.b)("h2",{id:"new-gonk-layer"},"New Gonk layer"),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},"Adapt to Android HIDL interface",Object(i.b)("ul",{parentName:"li"},Object(i.b)("li",{parentName:"ul"},"Unify the hardware abstraction interfaces defined by Google"),Object(i.b)("li",{parentName:"ul"},"May ease the porting efforts if new android version or new chipset coming")))),Object(i.b)("h3",{id:"hidl-interface-used-by-kaios30"},Object(i.b)("strong",{parentName:"h3"},"HIDL interface used by KaiOS3.0")),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},"android.hardware.gnss-2.0"),Object(i.b)("li",{parentName:"ul"},"android.hardware.gnss.measurement_corrections-1.0"),Object(i.b)("li",{parentName:"ul"},"android.hardware.gnss.visibility_control-1.0"),Object(i.b)("li",{parentName:"ul"},"android.hardware.graphics.bufferqueue-2.0"),Object(i.b)("li",{parentName:"ul"},"android.hardware.graphics.common-1.2"),Object(i.b)("li",{parentName:"ul"},"android.hardware.media-1.0"),Object(i.b)("li",{parentName:"ul"},"android.hardware.media.omx-1.0"),Object(i.b)("li",{parentName:"ul"},"android.hardware.radio-1.0"),Object(i.b)("li",{parentName:"ul"},"android.hardware.sensors-1.0"),Object(i.b)("li",{parentName:"ul"},"android.hardware.vibrator-1.0"),Object(i.b)("li",{parentName:"ul"},"android.hardware.wifi-1.3"),Object(i.b)("li",{parentName:"ul"},"android.hardware.wifi.hostapd-1.1"),Object(i.b)("li",{parentName:"ul"},"android.hardware.wifi.supplicant-1.2")),Object(i.b)("hr",null),Object(i.b)("h2",{id:"web-api-changes"},"Web API changes"),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},"API domain name change"),Object(i.b)("li",{parentName:"ul"},"Been moved to API-daemon"),Object(i.b)("li",{parentName:"ul"},"Deprecated Web APIs")),Object(i.b)("hr",null),Object(i.b)("h2",{id:"newkai-ril-design"},"NewKai-RIL design"),Object(i.b)("p",null,"There are two RIL services design for KaiOS 2.5"),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},Object(i.b)("strong",{parentName:"li"},"Kai-RIL"),": used for non-QCT platforms, implemented and maintained by KaiOS."),Object(i.b)("li",{parentName:"ul"},Object(i.b)("strong",{parentName:"li"},"QC-RIL"),"(b2g-RIL): For QCT platform only, implemented, maintained and released by QCT.")),Object(i.b)("p",null,"Since QCT is giving up QC-RIL, we decided to adapt Kai-RL to all chip platflorms in 3.0 via HIDL interfaces. "),Object(i.b)("h3",{id:"v25-ril"},"V2.5 RIL"),Object(i.b)("img",{alt:"V2.5 RIL",className:"responsive-img",src:Object(l.a)("img/introduction/RIL-2.5.png")}),Object(i.b)("h3",{id:"v30-ril"},"V3.0 RIL"),Object(i.b)("img",{alt:"V3.0 RIL",className:"responsive-img",src:Object(l.a)("img/introduction/RIL-3.0.png")}),Object(i.b)("hr",null),Object(i.b)("h2",{id:"service-worker-change"},"Service Worker change"),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},"No permission needed"),Object(i.b)("li",{parentName:"ul"},"Clients.openApp is not supported, using Clients.openWindow by following W3C standards"),Object(i.b)("li",{parentName:"ul"},"SystemMessage API supported and onsystemmessage event is introduced"),Object(i.b)("li",{parentName:"ul"},"Can inspect service workers script by Remote Debugging")),Object(i.b)("hr",null),Object(i.b)("h2",{id:"geolocation-change"},"Geolocation change"),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},"Geolocation API is following W3C standards"),Object(i.b)("li",{parentName:"ul"},"QCT provides iZat (Qualcomm Location) service in both 2.5 and 3.0"),Object(i.b)("li",{parentName:"ul"},"In 2.5, iZat is tightened up on QC-RIL. It provides GPS, AGPS, Wifi positioning, Cell info location."),Object(i.b)("li",{parentName:"ul"},"In 3.0, Kai-RIL connect iZat through HIDL interface. QCT didn\u2019t maintain Wifi positioning and use Skyhook in place."),Object(i.b)("li",{parentName:"ul"},"Using iZat service needs agreement from QCT in both 2.5 and 3.0. ")),Object(i.b)("hr",null),Object(i.b)("h2",{id:"new-apps-manager"},"New Apps manager"),Object(i.b)("p",null,"In KaiOS 3.0, mozApps API is removed and new apps manager is implemented in api-daemon."),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},Object(i.b)("strong",{parentName:"li"},Object(i.b)("a",Object(n.a)({parentName:"strong"},{href:"http://127.0.0.1/api/v1/apps/service.js"}),"http://127.0.0.1/api/v1/apps/service.js"))," "),Object(i.b)("li",{parentName:"ul"},"webapps-manager permission"),Object(i.b)("li",{parentName:"ul"},"App is launched with open api with url, Apps manager supports:",Object(i.b)("ul",{parentName:"li"},Object(i.b)("li",{parentName:"ul"},"App download/downloaded resume"),Object(i.b)("li",{parentName:"ul"},"Install/sideload package apps"),Object(i.b)("li",{parentName:"ul"},"Install PWA apps"),Object(i.b)("li",{parentName:"ul"},"Update/Uninstall apps"),Object(i.b)("li",{parentName:"ul"},"App signature check"),Object(i.b)("li",{parentName:"ul"},"Get apps list")))),Object(i.b)("hr",null),Object(i.b)("h2",{id:"app-types-in-kaios-30"},"App types in KaiOS 3.0"),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},Object(i.b)("strong",{parentName:"li"},"Core App (certified app in 2.5)"),Object(i.b)("ul",{parentName:"li"},Object(i.b)("li",{parentName:"ul"},"KaiOS native packaged apps, such as launcher app, settings app, calculator app and so on."),Object(i.b)("li",{parentName:"ul"},"stored in read-only /system, so can only be upgraded by FOTA."),Object(i.b)("li",{parentName:"ul"},"special app: store app and kai-pay app, store in /system, but copied to read-write /data, so can be upgraded without FOTA."))),Object(i.b)("li",{parentName:"ul"},Object(i.b)("strong",{parentName:"li"},"Signed App (priviliged app in 2.5)"),Object(i.b)("ul",{parentName:"li"},Object(i.b)("li",{parentName:"ul"},"3rd party packaged app preinstalled in /system, but copied to read-write /data or download from store and store in /data,\nboth can be upgraded without FOTA."))),Object(i.b)("li",{parentName:"ul"},Object(i.b)("strong",{parentName:"li"},"PWA App (hosted app in 2.5)"),Object(i.b)("ul",{parentName:"li"},Object(i.b)("li",{parentName:"ul"},"hosted 3rd apps from store or pwa webside")))),Object(i.b)("hr",null),Object(i.b)("h2",{id:"app-origin-changed-in-kaios-30"},"App origin changed in KaiOS 3.0"),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},"\u201capp://\u201d are removed, all app origins are \u201chttps://\u201d. For example, ",Object(i.b)("a",Object(n.a)({parentName:"li"},{href:"https://launcher.local"}),"https://launcher.local")," for launcher app and ",Object(i.b)("a",Object(n.a)({parentName:"li"},{href:"https://example.com"}),"https://example.com")," for PWA"),Object(i.b)("li",{parentName:"ul"},"App manager uses app origin and manifest to tell app types",Object(i.b)("ul",{parentName:"li"},Object(i.b)("li",{parentName:"ul"},"Core app: ",Object(i.b)("a",Object(n.a)({parentName:"li"},{href:"https://launcher.local"}),"https://launcher.local"),"  + manifest property, core: true"),Object(i.b)("li",{parentName:"ul"},"Signed app: https://app_name.local without manifest property \u201ccore\u201d"),Object(i.b)("li",{parentName:"ul"},"PWA: ",Object(i.b)("a",Object(n.a)({parentName:"li"},{href:"https://example.com"}),"https://example.com"))))),Object(i.b)("hr",null),Object(i.b)("h2",{id:"app-manifest"},"App manifest"),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},"PWA manifest w3c spec: ",Object(i.b)("a",Object(n.a)({parentName:"li"},{href:"https://w3c.github.io/manifest/"}),"https://w3c.github.io/manifest/")," (firefox 82)"),Object(i.b)("li",{parentName:"ul"},"Non-normative(B2G): ",Object(i.b)("a",Object(n.a)({parentName:"li"},{href:"https://w3c.github.io/manifest/#proprietary-extensions"}),"https://w3c.github.io/manifest/#proprietary-extensions")," (b2g_features)"),Object(i.b)("li",{parentName:"ul"},"File extension",Object(i.b)("ul",{parentName:"li"},Object(i.b)("li",{parentName:"ul"},"The latest w3c spec","[1]"," says .webmanifest is the official file extension for web apps,\nbut we do have .webapp and .json before the spec defined it.")))),Object(i.b)("h3",{id:"app-manifest-required"},"App manifest required"),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},Object(i.b)("strong",{parentName:"li"},"name or short_name: string")),Object(i.b)("li",{parentName:"ul"},Object(i.b)("strong",{parentName:"li"},"description: string")),Object(i.b)("li",{parentName:"ul"},Object(i.b)("strong",{parentName:"li"},"lang: String")),Object(i.b)("li",{parentName:"ul"},Object(i.b)("strong",{parentName:"li"},"theme_color: string")),Object(i.b)("li",{parentName:"ul"},Object(i.b)("strong",{parentName:"li"},"background_color: string")),Object(i.b)("li",{parentName:"ul"},Object(i.b)("strong",{parentName:"li"},"orientation: string")),Object(i.b)("li",{parentName:"ul"},Object(i.b)("strong",{parentName:"li"},"start_url: string")),Object(i.b)("li",{parentName:"ul"},Object(i.b)("strong",{parentName:"li"},"icons: Array of object"))),Object(i.b)("h3",{id:"app-manifest-optinal"},"App manifest optinal"),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},Object(i.b)("strong",{parentName:"li"},"dir: string")),Object(i.b)("li",{parentName:"ul"},Object(i.b)("strong",{parentName:"li"},"scope: string")),Object(i.b)("li",{parentName:"ul"},Object(i.b)("strong",{parentName:"li"},"display: string")),Object(i.b)("li",{parentName:"ul"},Object(i.b)("strong",{parentName:"li"},"orientation: string")),Object(i.b)("li",{parentName:"ul"},Object(i.b)("strong",{parentName:"li"},"related_applications: Array of object"))),Object(i.b)("hr",null),Object(i.b)("h2",{id:"permission-management"},"Permission Management"),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},"The permission manageent mechanism is the same in between 2.5 and 3.0."),Object(i.b)("li",{parentName:"ul"},"But the default permission table is changed in 3.0")),Object(i.b)("hr",null),Object(i.b)("h2",{id:"progressive-web-application-support-pwa"},"Progressive Web Application support (PWA)"),Object(i.b)("p",null,"No significant changes but better to check the support from MDN before using any PWA API."),Object(i.b)("hr",null),Object(i.b)("h2",{id:"gaia-change"},"Gaia Change"),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},"We replace the build runtime from XPCShell to nodejs, but no changes on the build usage/logic/options."),Object(i.b)("li",{parentName:"ul"},"We have moved lots of js/resources from gaia/shared to shared app. Now can import from ",Object(i.b)("a",Object(n.a)({parentName:"li"},{href:"https://shared.local"}),"https://shared.local")," instead of copying to app's application.zip.")))}s.isMDXComponent=!0},398:function(e,t,a){"use strict";a.d(t,"a",(function(){return s})),a.d(t,"b",(function(){return m}));var n=a(0),r=a.n(n);function i(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function l(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function p(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?l(Object(a),!0).forEach((function(t){i(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):l(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function o(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},i=Object.keys(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var c=r.a.createContext({}),b=function(e){var t=r.a.useContext(c),a=t;return e&&(a="function"==typeof e?e(t):p(p({},t),e)),a},s=function(e){var t=b(e.components);return r.a.createElement(c.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return r.a.createElement(r.a.Fragment,{},t)}},d=r.a.forwardRef((function(e,t){var a=e.components,n=e.mdxType,i=e.originalType,l=e.parentName,c=o(e,["components","mdxType","originalType","parentName"]),s=b(a),d=n,m=s["".concat(l,".").concat(d)]||s[d]||u[d]||i;return a?r.a.createElement(m,p(p({ref:t},c),{},{components:a})):r.a.createElement(m,p({ref:t},c))}));function m(e,t){var a=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var i=a.length,l=new Array(i);l[0]=d;var p={};for(var o in t)hasOwnProperty.call(t,o)&&(p[o]=t[o]);p.originalType=e,p.mdxType="string"==typeof e?e:n,l[1]=p;for(var c=2;c<i;c++)l[c]=a[c];return r.a.createElement.apply(null,l)}return r.a.createElement.apply(null,a)}d.displayName="MDXCreateElement"},399:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a(23);t.default=function(){var e=Object(n.useContext)(r.a);if(null===e)throw new Error("Docusaurus context not provided");return e}},400:function(e,t,a){"use strict";a.d(t,"b",(function(){return i})),a.d(t,"a",(function(){return l}));var n=a(399),r=a(401);function i(){var e=Object(n.default)().siteConfig,t=(e=void 0===e?{}:e).baseUrl,a=void 0===t?"/":t,i=e.url;return{withBaseUrl:function(e,t){return function(e,t,a,n){var i=void 0===n?{}:n,l=i.forcePrependBaseUrl,p=void 0!==l&&l,o=i.absolute,c=void 0!==o&&o;if(!a)return a;if(a.startsWith("#"))return a;if(Object(r.b)(a))return a;if(p)return t+a;var b=a.startsWith(t)?a:t+a.replace(/^\//,"");return c?e+b:b}(i,a,e,t)}}}function l(e,t){return void 0===t&&(t={}),(0,i().withBaseUrl)(e,t)}},401:function(e,t,a){"use strict";function n(e){return!0===/^(\w*:|\/\/)/.test(e)}function r(e){return void 0!==e&&!n(e)}a.d(t,"b",(function(){return n})),a.d(t,"a",(function(){return r}))}}]);